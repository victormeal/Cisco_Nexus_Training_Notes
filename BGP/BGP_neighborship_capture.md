# BGP

+ Ethanalyzer when a BGP neighbor is coming up

```
F241.06.05-N3K-C36180YC-1# ethanalyzer local interface inband display-filter "ip.addr==192.168.100.1 and ip.addr==192.168.100.2" limit-captured-frames 0
Capturing on 'ps-inb'
   99 2022-05-19 17:05:05.391514640 192.168.100.1 → 192.168.100.2 TCP 122 44692 → 179 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 SACK_PERM=1 TSval=3797562153 TSecr=0 WS=4
  100 2022-05-19 17:05:05.391740752 192.168.100.2 → 192.168.100.1 TCP 166 179 → 44692 [SYN, ACK] Seq=0 Ack=1 Win=65535 Len=0 MSS=1460 SACK_PERM=1 TSval=3622737417 TSecr=3797562153 WS=4
  101 2022-05-19 17:05:05.391812436 192.168.100.1 → 192.168.100.2 TCP 114 44692 → 179 [ACK] Seq=1 Ack=1 Win=65536 Len=0 TSval=3797562154 TSecr=3622737417
  102 2022-05-19 17:05:05.392618149 192.168.100.2 → 192.168.100.1 BGP 234 OPEN Message
  103 2022-05-19 17:05:05.392636757 192.168.100.1 → 192.168.100.2 TCP 114 44692 → 179 [ACK] Seq=1 Ack=77 Win=65536 Len=0 TSval=3797562155 TSecr=3622737418
  104 2022-05-19 17:05:05.770515683 192.168.100.1 → 192.168.100.2 BGP 190 OPEN Message
  105 2022-05-19 17:05:05.770724921 192.168.100.2 → 192.168.100.1 TCP 158 179 → 44692 [ACK] Seq=77 Ack=77 Win=65536 Len=0 TSval=3622737796 TSecr=3797562532
  106 2022-05-19 17:05:05.771347366 192.168.100.2 → 192.168.100.1 BGP 177 KEEPALIVE Message
  107 2022-05-19 17:05:05.771370592 192.168.100.1 → 192.168.100.2 TCP 114 44692 → 179 [ACK] Seq=77 Ack=96 Win=65536 Len=0 TSval=3797562533 TSecr=3622737797
  108 2022-05-19 17:05:05.771867832 192.168.100.1 → 192.168.100.2 BGP 133 KEEPALIVE Message
  109 2022-05-19 17:05:05.814371900 192.168.100.2 → 192.168.100.1 TCP 158 179 → 44692 [ACK] Seq=96 Ack=96 Win=65536 Len=0 TSval=3622737840 TSecr=3797562534
11   122 2022-05-19 17:05:06.773893672 192.168.100.2 → 192.168.100.1 BGP 206 UPDATE Message, KEEPALIVE Message
  123 2022-05-19 17:05:06.774196163 192.168.100.1 → 192.168.100.2 BGP 162 UPDATE Message, KEEPALIVE Message
  124 2022-05-19 17:05:06.774374580 192.168.100.2 → 192.168.100.1 TCP 158 179 → 44692 [ACK] Seq=144 Ack=144 Win=65536 Len=0 TSval=3622738800 TSecr=3797563536
14 


14   578 2022-05-19 17:06:06.774546076 192.168.100.2 → 192.168.100.1 BGP 177 KEEPALIVE Message
  579 2022-05-19 17:06:06.774998059 192.168.100.1 → 192.168.100.2 BGP 133 KEEPALIVE Message
  580 2022-05-19 17:06:06.775166045 192.168.100.2 → 192.168.100.1 TCP 158 179 → 44692 [ACK] Seq=163 Ack=163 Win=65536 Len=0 TSval=3622798800 TSecr=3797623537
17 


==================

ethanalyzer local interface inband display-filter "bgp or (ip.addr==192.168.100.1 and ip.addr==192.168.100.2)" limit-captured-frames 0


F241.06.05-N3K-C36180YC-1# ethanalyzer local interface inband display-filter "ip.addr==192.168.100.1 and ip.addr==192.168.100.2" limit-captured-frames 0
Capturing on 'ps-inb'
   24 2022-05-19 17:08:22.115796719 192.168.100.1 → 192.168.100.2 TCP 122 49420 → 179 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 SACK_PERM=1 TSval=3797758878 TSecr=0 WS=4
   25 2022-05-19 17:08:22.115942262 192.168.100.2 → 192.168.100.1 TCP 166 179 → 49420 [SYN, ACK] Seq=0 Ack=1 Win=65535 Len=0 MSS=1460 SACK_PERM=1 TSval=3622934141 TSecr=3797758878 WS=4
   26 2022-05-19 17:08:22.115993584 192.168.100.1 → 192.168.100.2 TCP 114 49420 → 179 [ACK] Seq=1 Ack=1 Win=65536 Len=0 TSval=3797758878 TSecr=3622934141
   27 2022-05-19 17:08:22.116228806 192.168.100.2 → 192.168.100.1 TCP 158 179 → 49420 [FIN, ACK] Seq=1 Ack=1 Win=65536 Len=0 TSval=3622934142 TSecr=3797758878
   28 2022-05-19 17:08:22.117045608 192.168.100.1 → 192.168.100.2 TCP 114 49420 → 179 [ACK] Seq=1 Ack=2 Win=65536 Len=0 TSval=3797758879 TSecr=3622934142
   31 2022-05-19 17:08:22.315971679 192.168.100.1 → 192.168.100.2 BGP 190 OPEN Message
   32 2022-05-19 17:08:22.316153365 192.168.100.2 → 192.168.100.1 TCP 152 179 → 49420 [RST] Seq=2 Win=0 Len=0
7    77 2022-05-19 17:08:28.778112039 192.168.100.2 → 192.168.100.1 TCP 166 42318 → 179 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 SACK_PERM=1 TSval=3622940803 TSecr=0 WS=4
   78 2022-05-19 17:08:28.778230029 192.168.100.1 → 192.168.100.2 TCP 122 179 → 42318 [SYN, ACK] Seq=0 Ack=1 Win=65535 Len=0 MSS=1460 SACK_PERM=1 TSval=3797765540 TSecr=3622940803 WS=4
   79 2022-05-19 17:08:28.778407213 192.168.100.2 → 192.168.100.1 TCP 158 42318 → 179 [ACK] Seq=1 Ack=1 Win=65536 Len=0 TSval=3622940804 TSecr=3797765540
   80 2022-05-19 17:08:28.779101786 192.168.100.1 → 192.168.100.2 BGP 190 OPEN Message
   81 2022-05-19 17:08:28.779222460 192.168.100.2 → 192.168.100.1 TCP 158 42318 → 179 [ACK] Seq=1 Ack=77 Win=65536 Len=0 TSval=3622940805 TSecr=3797765541
   82 2022-05-19 17:08:28.815963474 192.168.100.2 → 192.168.100.1 BGP 234 OPEN Message
   83 2022-05-19 17:08:28.816000974 192.168.100.1 → 192.168.100.2 TCP 114 179 → 42318 [ACK] Seq=77 Ack=77 Win=65536 Len=0 TSval=3797765578 TSecr=3622940841
   84 2022-05-19 17:08:28.817343925 192.168.100.2 → 192.168.100.1 BGP 177 KEEPALIVE Message
   85 2022-05-19 17:08:28.817375390 192.168.100.1 → 192.168.100.2 TCP 114 179 → 42318 [ACK] Seq=77 Ack=96 Win=65536 Len=0 TSval=3797765579 TSecr=3622940843
   86 2022-05-19 17:08:28.819854955 192.168.100.1 → 192.168.100.2 BGP 133 KEEPALIVE Message
   87 2022-05-19 17:08:28.861047288 192.168.100.2 → 192.168.100.1 TCP 158 42318 → 179 [ACK] Seq=96 Ack=96 Win=65536 Len=0 TSval=3622940886 TSecr=3797765582
18    91 2022-05-19 17:08:29.821601445 192.168.100.2 → 192.168.100.1 BGP 206 UPDATE Message, KEEPALIVE Message
   92 2022-05-19 17:08:29.822950812 192.168.100.1 → 192.168.100.2 BGP 162 UPDATE Message, KEEPALIVE Message
   93 2022-05-19 17:08:29.823120321 192.168.100.2 → 192.168.100.1 TCP 158 42318 → 179 [ACK] Seq=144 Ack=144 Win=65536 Len=0 TSval=3622941848 TSecr=3797766585
21 

```
